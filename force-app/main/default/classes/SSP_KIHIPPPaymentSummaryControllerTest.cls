@isTest
public class SSP_KIHIPPPaymentSummaryControllerTest implements HttpCalloutMock { 
    public static SSP_Application__c createApplication(Integer caseNumber){
        
        Account acc = new Account(Name='TestName');
        insert acc;
        Id recordTypeId = Schema.SObjectType.SSP_Application__c.getRecordTypeInfosByDeveloperName().get('Case').getRecordTypeId();
        SSP_Application__c application = new SSP_Application__c(
                                                RecordTypeId = recordTypeId,
                                                DCCaseNumber__c =caseNumber,
                                                Account__c = acc.Id);
        
        insert application;
        return application;
    } 
    public static SSP_RSSPDC_RequestWrapper prepareRequestWrapper(String viewName, Id applicationId, String primAppIndivId) {
        SSP_RSSPDC_RequestWrapper requestWrapper = new SSP_RSSPDC_RequestWrapper();
        requestWrapper.caseNumber                     = 123456;
        requestWrapper.mode                           = 'Intake';
        requestWrapper.miscelleanousParameter         = '';
        requestWrapper.primaryApplicationIndividualId = primAppIndivId;
        requestWrapper.individualIds                  = '999018553;1234567;2345678;3456789';
        requestWrapper.viewName                       = viewName;
        requestWrapper.applicationID                  = applicationId;
        
        return requestWrapper;
    }
    
    @isTest
    public static void testKIHIPPPaymentSummaryController() {
        
        String individualId = '8973647';
                Id applicationId = createApplication(8973647).Id;

        Test.setMock(HttpCalloutMock.class, new TestHTTPMock_KIHIPPPaymentSummary());
        Test.startTest();
        SSP_LightningResponse response = SSP_KIHIPPPaymentSummaryController.fetchPaymentSummary(individualId);
        system.assertNotEquals(null, response);
        String mastercard = JSON.serialize(SSP_KIHIPPPaymentSummaryController.lstMasterCards);

        SSP_KIHIPPPaymentSummaryController.fetchMoreRecords('8973647',1,mastercard);
       Test.stopTest();
    }

    public HTTPResponse respond(HTTPRequest req) {
        // Create a test response
        HttpResponse res = new HttpResponse();
        res.setHeader('Content-Type', 'application/json');
        //res.setBody('    {       "waiverDetailsPayload":null,       "viewName":"KHIPPPaymentSummary",       "taxForms1095AInfoPayload":null,       "role":"Citizen_Individual",       "RFIInformationPayload":null,       "racSelectionWrapper":null,       "primaryApplicationIndividualId":null,       "Payload":{          "Summary":[             {                "TotalPremium":"31.50",                "TotalAmount":"31.50",                "ReimbursedMonth_Year":"Jul 2019",                "ReimbursedDate":"2019-07-05",                "KHIPPFinalPaymentId":"1013614135",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "CaseNumber":"110362091",                "Adjustment":null             },             {                "TotalPremium":"31.50",                "TotalAmount":"31.50",                "ReimbursedMonth_Year":"Jul 2019",                "ReimbursedDate":"2019-07-26",                "KHIPPFinalPaymentId":"1013874051",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "CaseNumber":"110362091",                "Adjustment":null             },             {                "TotalPremium":"31.50",                "TotalAmount":"31.50",                "ReimbursedMonth_Year":"Aug 2019",                "ReimbursedDate":"2019-08-23",                "KHIPPFinalPaymentId":"1014147643",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "CaseNumber":"110362091",                "Adjustment":null             },             {                "TotalPremium":"31.50",                "TotalAmount":"31.50",                "ReimbursedMonth_Year":"Sep 2019",                "ReimbursedDate":"2019-09-27",                "KHIPPFinalPaymentId":"1014427594",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "CaseNumber":"110362091",                "Adjustment":null             },             {                "TotalPremium":"31.50",                "TotalAmount":"31.50",                "ReimbursedMonth_Year":"Nov 2019",                "ReimbursedDate":"2019-11-01",                "KHIPPFinalPaymentId":"1014710231",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "CaseNumber":"110362091",                "Adjustment":null             },             {                "TotalPremium":"31.50",                "TotalAmount":"31.50",                "ReimbursedMonth_Year":"Nov 2019",                "ReimbursedDate":"2019-11-29",                "KHIPPFinalPaymentId":"1014977100",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "CaseNumber":"110362091",                "Adjustment":null             }          ],          "PremiumDetails":[             {                "ReimbursedDate":"2019-07-05",                "KHIPPFinalPaymentId":"1013614135",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "ElectiveAbortion":"-1.00",                "CaseNumber":"110362091",                "BenefitMonth_Year":"Jun 2019",                "ApprovedPremium":"32.50"             },             {                "ReimbursedDate":"2019-07-26",                "KHIPPFinalPaymentId":"1013874051",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "ElectiveAbortion":"-1.00",                "CaseNumber":"110362091",                "BenefitMonth_Year":"Jul 2019",                "ApprovedPremium":"32.50"             },             {                "ReimbursedDate":"2019-08-23",                "KHIPPFinalPaymentId":"1014147643",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "ElectiveAbortion":"-1.00",                "CaseNumber":"110362091",                "BenefitMonth_Year":"Aug 2019",                "ApprovedPremium":"32.50"             },             {                "ReimbursedDate":"2019-09-27",                "KHIPPFinalPaymentId":"1014427594",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "ElectiveAbortion":"-1.00",                "CaseNumber":"110362091",                "BenefitMonth_Year":"Sep 2019",                "ApprovedPremium":"32.50"             },             {                "ReimbursedDate":"2019-11-01",                "KHIPPFinalPaymentId":"1014710231",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "ElectiveAbortion":"-1.00",                "CaseNumber":"110362091",                "BenefitMonth_Year":"Oct 2019",                "ApprovedPremium":"32.50"             },             {                "ReimbursedDate":"2019-11-29",                "KHIPPFinalPaymentId":"1014977100",                "IndividualName":"XFPUL YGFBCGVFFSQ",                "IndividualId":"100837461",                "ElectiveAbortion":"-1.00",                "CaseNumber":"110362091",                "BenefitMonth_Year":"Nov 2019",                "ApprovedPremium":"32.50"             }          ],          "AdjustmentDetails":null       },       "PastApplicationsPayload":null,       "nonCitizenSearchExportPayload":null,       "nonCitizenSearchCasePayload":null,       "nonCitizenClientInfoPayload":null,       "mode":"",       "miscelleanousParameters":null,       "medicaidMCOInformation":null,       "KIHIPPPreferredPaymentPayload":null,       "KHIPPPaymentSummaryPayload": null,       "individualIds":"",       "hearingsSummaryInfoPayload":null,       "EligibilitySummaryPayload":null,       "DisqualificationPayload":null,       "dashboardInformation":null,       "dashboardCaseInfo":null,       "claimsOverviewPayload":null,       "caseNumber":0,       "benefitInformations":null,       "assisterAuthRepDetailsPayload":null,       "applicationID":"",       "ACKRESPONSE":null    } ');
        res.setBody('{    "waiverDetailsPayload":null,    "viewName":"KHIPPPaymentSummary",    "taxForms1095AInfoPayload":null,    "role":"Citizen_Individual",    "RFIInformationPayload":null,    "racSelectionWrapper":null,    "primaryApplicationIndividualId":null,    "Payload":{    "AdjustmentDetails":[          {             "CaseNumber":"110362091",             "IndividualId":"100837461",             "KHIPPFinalPaymentId":"1014977100",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "ReimbursedDate":"2019-12-29",             "BenefitMonth_Year":"Dec 2019",             "AdjustmentAmount":"60",             "Reason":"Reason"          },          {             "CaseNumber":"110362091",             "IndividualId":"100837461",             "KHIPPFinalPaymentId":"1014977100",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "ReimbursedDate":"2019-11-28",             "BenefitMonth_Year":"Nov 2019",             "AdjustmentAmount":"45",             "Reason":"Reason2"          }       ],       "Summary":[          {             "TotalPremium":"31.50",             "TotalAmount":"31.50",             "ReimbursedMonth_Year":"Jul 2019",             "ReimbursedDate":"2019-07-05",             "KHIPPFinalPaymentId":"1013614135",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "CaseNumber":"110362091",             "Adjustment":null          },          {             "TotalPremium":"31.50",             "TotalAmount":"31.50",             "ReimbursedMonth_Year":"Jul 2019",             "ReimbursedDate":"2019-07-26",             "KHIPPFinalPaymentId":"1013874051",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "CaseNumber":"110362091",             "Adjustment":null          },          {             "TotalPremium":"31.50",             "TotalAmount":"31.50",             "ReimbursedMonth_Year":"Aug 2019",             "ReimbursedDate":"2019-08-23",             "KHIPPFinalPaymentId":"1014147643",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "CaseNumber":"110362091",             "Adjustment":null          },          {             "TotalPremium":"31.50",             "TotalAmount":"31.50",             "ReimbursedMonth_Year":"Sep 2019",             "ReimbursedDate":"2019-09-27",             "KHIPPFinalPaymentId":"1014427594",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "CaseNumber":"110362091",             "Adjustment":null          },          {             "TotalPremium":"31.50",             "TotalAmount":"31.50",             "ReimbursedMonth_Year":"Nov 2019",             "ReimbursedDate":"2019-11-01",             "KHIPPFinalPaymentId":"1014710231",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "CaseNumber":"110362091",             "Adjustment":null          },          {             "TotalPremium":"31.50",             "TotalAmount":"31.50",             "ReimbursedMonth_Year":"Nov 2019",             "ReimbursedDate":"2019-11-29",             "KHIPPFinalPaymentId":"1014977100",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "CaseNumber":"110362091",             "Adjustment":105          }       ],       "PremiumDetails":[          {             "ReimbursedDate":"2019-07-05",             "KHIPPFinalPaymentId":"1013614135",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "ElectiveAbortion":"-1.00",             "CaseNumber":"110362091",             "BenefitMonth_Year":"Jun 2019",             "ApprovedPremium":"32.50"          },          {             "ReimbursedDate":"2019-07-26",             "KHIPPFinalPaymentId":"1013874051",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "ElectiveAbortion":"-1.00",             "CaseNumber":"110362091",             "BenefitMonth_Year":"Jul 2019",             "ApprovedPremium":"32.50"          },          {             "ReimbursedDate":"2019-08-23",             "KHIPPFinalPaymentId":"1014147643",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "ElectiveAbortion":"-1.00",             "CaseNumber":"110362091",             "BenefitMonth_Year":"Aug 2019",             "ApprovedPremium":"32.50"          },          {             "ReimbursedDate":"2019-09-27",             "KHIPPFinalPaymentId":"1014427594",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "ElectiveAbortion":"-1.00",             "CaseNumber":"110362091",             "BenefitMonth_Year":"Sep 2019",             "ApprovedPremium":"32.50"          },          {             "ReimbursedDate":"2019-11-01",             "KHIPPFinalPaymentId":"1014710231",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "ElectiveAbortion":"-1.00",             "CaseNumber":"110362091",             "BenefitMonth_Year":"Oct 2019",             "ApprovedPremium":"32.50"          },          {             "ReimbursedDate":"2019-11-29",             "KHIPPFinalPaymentId":"1014977100",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "ElectiveAbortion":"-1.00",             "CaseNumber":"110362091",             "BenefitMonth_Year":"Nov 2019",             "ApprovedPremium":"32.50"          },          {             "ReimbursedDate":"2019-11-29",             "KHIPPFinalPaymentId":"1014977100",             "IndividualName":"XFPUL YGFBCGVFFSQ",             "IndividualId":"100837461",             "ElectiveAbortion":"-1.00",             "CaseNumber":"110362091",             "BenefitMonth_Year":"Dec 2019",             "ApprovedPremium":"80"          }       ]           },    "PastApplicationsPayload":null,    "nonCitizenSearchExportPayload":null,    "nonCitizenSearchCasePayload":null,    "nonCitizenClientInfoPayload":null,    "mode":"",    "miscelleanousParameters":null,    "medicaidMCOInformation":null,    "KIHIPPPreferredPaymentPayload":null,    "KHIPPPaymentSummaryPayload":null,    "individualIds":"",    "hearingsSummaryInfoPayload":null,    "EligibilitySummaryPayload":null,    "DisqualificationPayload":null,    "dashboardInformation":null,    "dashboardCaseInfo":null,    "claimsOverviewPayload":null,    "caseNumber":0,    "benefitInformations":null,    "assisterAuthRepDetailsPayload":null,    "applicationID":"",    "ACKRESPONSE":null } ');
        res.setStatusCode(200);
        system.debug('## mock getting called');
        return res;
    }
}